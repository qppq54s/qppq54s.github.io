[
  {
    "filename": "data.js",
    "code": "import BaseNode from './node';\nimport BaseEdge from './edge';\n\nexport default {\n  nodes: [\n    {\n      id: '0',\n      text: 'Fire Incident',\n      top: 10,\n      left: 520,\n      width: 100,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }]\n    }, {\n      id: '1',\n      text: 'Auto alarm activated',\n      top: 110,\n      left: 500,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'right',\n        orientation: [1, 0],\n        pos: [0, 0.5]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, {\n        id: 'left',\n        orientation: [-1, 0],\n        pos: [0, 0.5]\n      }]\n    }, {\n      id: '2',\n      text: 'Employees manua…',\n      top: 110,\n      left: 200,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'right',\n        orientation: [1, 0],\n        pos: [0, 0.5]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }]\n    }, {\n      id: '3',\n      text: 'Actiate evacuation',\n      top: 110,\n      left: 850,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, {\n        id: 'left',\n        orientation: [-1, 0],\n        pos: [0, 0.5]\n      }]\n    }, {\n      id: '4',\n      text: 'Alarm monitoring service…',\n      top: 210,\n      left: 500,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, {\n        id: 'left',\n        orientation: [-1, 0],\n        pos: [0, 0.5]\n      }]\n    }, {\n      id: '5',\n      text: 'Employees informs pri…',\n      top: 210,\n      left: 200,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'right',\n        orientation: [1, 0],\n        pos: [0, 0.5]\n      }]\n    }, {\n      id: '6',\n      text: 'Evacuees report …',\n      top: 190,\n      left: 850,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ]\n    }, {\n      id: '7',\n      text: 'Roll call taken by …',\n      top: 280,\n      left: 850,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ]\n    }, {\n      id: '8',\n      text: 'Floor Marshals brief…',\n      top: 370,\n      left: 850,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }],\n    }, {\n      id: '9',\n      text: 'Primary contact con…',\n      top: 310,\n      left: 350,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ],\n    }, {\n      id: '10',\n      text: 'Primary contect infor…',\n      top: 410,\n      left: 350,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ],\n    }, {\n      id: '11',\n      text: 'Emergency response…',\n      top: 510,\n      left: 350,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }],\n    }, {\n      id: '12',\n      text: 'Primary contact fire…',\n      top: 310,\n      left: 650,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ],\n    }, {\n      id: '13',\n      text: 'Service Provider…',\n      top: 410,\n      left: 650,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }, {\n        id: 'bottom',\n        orientation: [0, 1],\n        pos: [0.5, 0]\n      }, ],\n    }, {\n      id: '14',\n      text: 'Fire Engines arr…',\n      top: 510,\n      left: 650,\n      width: 140,\n      height: 30,\n      shape: 'rect',\n      Class: BaseNode,\n      endpoints: [{\n        id: 'top',\n        orientation: [0, -1],\n        pos: [0.5, 0]\n      }],\n    }],\n\n  edges: [{\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '0',\n    targetNode: '1',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'left',\n    target: 'right',\n    sourceNode: '1',\n    targetNode: '2',\n    type: 'endpoint',\n    arrow: true,\n    label: 'No',\n    arrowPosition: 0.7,\n    Class: BaseEdge\n  }, {\n    source: 'right',\n    target: 'left',\n    sourceNode: '1',\n    targetNode: '3',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '1',\n    targetNode: '4',\n    type: 'endpoint',\n    arrow: true,\n    label: 'Yes',\n    arrowPosition: 0.8,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '2',\n    targetNode: '5',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'right',\n    target: 'left',\n    sourceNode: '5',\n    targetNode: '4',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '3',\n    targetNode: '6',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '6',\n    targetNode: '7',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '7',\n    targetNode: '8',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '9',\n    targetNode: '10',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '10',\n    targetNode: '11',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '12',\n    targetNode: '13',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '13',\n    targetNode: '14',\n    type: 'endpoint',\n    arrow: true,\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '4',\n    targetNode: '9',\n    type: 'endpoint',\n    shapeType: 'AdvancedBezier',\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }, {\n    source: 'bottom',\n    target: 'top',\n    sourceNode: '4',\n    targetNode: '12',\n    type: 'endpoint',\n    shapeType: 'AdvancedBezier',\n    arrowPosition: 0.5,\n    Class: BaseEdge\n  }],\n  groupd: []\n};\n"
  },
  {
    "filename": "edge.js",
    "code": "import $ from 'jquery';\nimport {Edge} from 'butterfly-dag';\n\nclass BaseEdge extends Edge {\n  draw(obj) {\n    let path = super.draw(obj);\n    if (this.options.color) {\n      $(path).addClass(this.options.color);\n    }\n    return path;\n  }\n\n  drawArrow(isShow) {\n    let dom = super.drawArrow(isShow);\n    if (this.options.color) {\n      $(dom).addClass(this.options.color);\n    }\n    return dom;\n  }\n\n  drawLabel(text) {\n    let dom = null;\n    if (text) {\n      dom = $(`<span class=\"label\">${text}</span>`)[0];\n    }\n    return dom;\n  }\n}\n\nexport default BaseEdge;\n"
  },
  {
    "filename": "index.jsx",
    "code": "import {Canvas} from 'butterfly-dag';\nimport ReactDOM from 'react-dom';\nimport React, {Component} from 'react';\n\nimport mockData from './data.js';\n\nimport './index.less';\nimport 'butterfly-dag/dist/index.css';\n\nclass Emergency2 extends Component {\n  componentDidMount() {\n    let root = document.getElementById('dag-canvas');\n    this.canvas = new Canvas({\n      root: root,\n      disLinkable: true, // 可删除连线\n      linkable: true,    // 可连线\n      draggable: true,   // 可拖动\n      zoomable: true,    // 可放大\n      moveable: true,    // 可平移\n      theme: {\n        edge: {\n          type: 'Manhattan',\n          arrow: true\n        },\n        // 拖动边缘处自动适应画布\n        autoFixCanvas: {\n          enable: true\n        }\n      }\n    });\n    this.canvas.draw(mockData);\n  }\n\n  render() {\n    return (\n      <div className='emergency2-page'>\n        <div className=\"emergency2-canvas\" id=\"dag-canvas\">\n        </div>\n      </div>\n    );\n  }\n}\n\nReactDOM.render(<Emergency2 />, document.getElementById('root'));\n"
  },
  {
    "filename": "index.less",
    "code": "@import 'theme.less'; \n\n\n.emergency2-page {\n  width: 100%;\n  height: 100%;\n  .emergency2-canvas {\n    width: 100%;\n    height: 100%;\n  }\n  .emergency2-base-node {\n    position: absolute;\n    text-align: center;\n    background: @butterfly-theme-color;\n    vertical-align: middle;\n    border-radius: 5px;\n    line-height: 28px;\n    color: @butterfly-normal-font-color;\n    .top{\n      top: -3px;\n      left: -3%;\n    }\n    .right{\n      top: -3px;\n      right: -3px;\n    }\n    .bottom{\n      bottom: -3px;\n      right: -3px;\n    }\n    .left{\n      bottom: -3px;\n      left: -3px;\n    }\n    border: @butterfly-box-border;\n    box-shadow: @butterfly-box-shadow;\n  }\n  .rect {\n    border-radius: 80px;\n  }\n\n  .test-base-link{\n    stroke: #4b4f6b;\n    stroke-width: 3px;\n  }\n  .text {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    display: -webkit-box;    \n    -webkit-box-orient: vertical;    \n    -webkit-line-clamp: 3;    \n    overflow: hidden;\n    font-size: 12px;\n  }\n  .label {\n    position: absolute;\n    font-size: 12px;\n    width: 30px;\n    height: 18px;\n    line-height: 18px;\n    color: @butterfly-normal-font-color;\n    text-align: center;\n    background: @butterfly-theme-color;\n    border-radius: 80px;\n  }\n}"
  },
  {
    "filename": "node.js",
    "code": "import {Node} from 'butterfly-dag';\nimport $ from 'jquery';\n\nclass BaseNode extends Node {\n  mounted() {\n    // 假如菱形的话定制锚点，可指定任意的dom为endopoint\n    // console.log(this)\n    if (this.options.shape === 'diamond') {\n      let pointPos = ['top', 'right', 'bottom', 'left'];\n      pointPos.forEach((pos) => {\n        let point = $(`<div class='butterflie-circle-endpoint ${pos}'></div>`);\n        $(this.dom).append(point);\n        let obj = {\n          id: `${pos}`,\n          orientation: [pointPos.indexOf(pos) % 1 === 1 ? 1 : 0, pointPos.indexOf(pos) % 1 === 1 ? 0 : 1],\n          dom: point[0]\n        };\n        if (pos === 'top') {\n          obj.orientation = [0, -1];\n        } else if (pos === 'right') {\n          obj.orientation = [1, 0];\n        } else if (pos === 'bottom') {\n          obj.orientation = [0, 1];\n        } else if (pos === 'left') {\n          obj.orientation = [-1, 0];\n        }\n        this.addEndpoint(obj);\n      });\n    }\n\n    // 把锚点添加颜色\n    if (this.endpoints && this.endpoints.length > 0) {\n      this.endpoints.forEach((point) => {\n        $(point.dom).addClass(this.options.color);\n      });\n    }\n  }\n\n  draw = (data) => {\n    let container = $('<div class=\"emergency2-base-node\"></div>')\n      .css('top', data.top)\n      .css('left', data.left)\n      .css('width', data.options.width)\n      .css('height', data.options.height)\n      .attr('id', data.id);\n\n    // 添加颜色\n    if (data.options.color) {\n      container.addClass(data.options.color);\n    }\n\n    // 添加外边框\n    if (data.options.border) {\n      container.addClass(data.options.border);\n    }\n\n    // 渲染外形\n    container.addClass(data.options.shape);\n\n    // 添加文字\n    let textSpan = $(`<span class='text'>${data.options.text}</span>`);\n    if (data.options.shape === 'diamond') {\n      textSpan.addClass('rotate');\n    }\n    container.append(textSpan);\n\n    return container[0];\n  }\n}\n\nexport default BaseNode;\n"
  },
  {
    "filename": "package.json",
    "code": "{\n  \"name\": \"emergency2\",\n  \"cn_name\": \"紧急情况决策树2\",\n  \"description\": \"yet another dag to show to how to make a decision when in a emergency\",\n  \"cn_description\": \"另外一个决策树，用于展示如何在紧急情况下做决定\",\n  \"dependencies\": {\n    \"butterfly-dag\": \"*\",\n    \"react\": \"^16.0.0\",\n    \"react-dom\": \"^16.0.0\",\n    \"jquery\": \"*\",\n    \"lodash\": \"*\",\n    \"antd\": \"^3.0.0\"\n  }\n}"
  },
  {
    "filename": "theme.less",
    "code": "@butterfly-theme-color-base:#fff;\n@butterfly-normal-font-color-base:#222;;\n@butterfly-overlay-font-color-base:#FFF;\n@butterfly-primary-color-base:#F66902;\n@butterfly-box-border-color-base: #D9D9D9;\n@butterfly-box-shadow-base:0 2px 3px 0 rgba(0,112,204,0.06);\n@butterfly-box-radius-base:100px;\n@butterfly-line-color-base: #BFBFBF;\n// 主题背景色（画布背景色）\n@butterfly-theme-background-color: @butterfly-theme-color-base;\n// （各图形框）普通情况背景色\n@butterfly-theme-color: fade(@butterfly-theme-color-base,80%);\n// 主题色\n@butterfly-primary-color: @butterfly-primary-color-base;\n// 普通情况下字体颜色\n@butterfly-normal-font-color: @butterfly-normal-font-color-base;\n// 主题背景色上的字体颜色及icon颜色\n@butterfly-overlay-font-color: @butterfly-overlay-font-color-base;\n// 拖动时的背景色\n@butterfly-box-move-background-color: fade(@butterfly-primary-color, 20%);\n// 边框的样式\n@butterfly-box-border: 1px solid @butterfly-box-border-color-base;\n@butterfly-box-shadow: @butterfly-box-shadow-base;\n@butterfly-box-radius: @butterfly-box-radius-base;\n@butterfly-box-node-border-hover: 1px solid @butterfly-primary-color;\n// 线条样式\n@butterfly-line-color: @butterfly-line-color-base;"
  }
]