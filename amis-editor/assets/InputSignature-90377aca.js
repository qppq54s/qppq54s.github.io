import{c as s,a as I,h as T,j,af as F,R as O,cJ as R,d as L,e as p,n as x,o as b,p as $,F as M,z as E,cK as k}from"./main-42426a16.js";var C={},m={},P=s&&s.__awaiter||function(o,c,n,a){function r(e){return e instanceof n?e:new n(function(i){i(e)})}return new(n||(n=Promise))(function(e,i){function l(u){try{t(a.next(u))}catch(d){i(d)}}function f(u){try{t(a.throw(u))}catch(d){i(d)}}function t(u){u.done?e(u.value):r(u.value).then(l,f)}t((a=a.apply(o,c||[])).next())})},A=s&&s.__generator||function(o,c){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a,r,e,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(u){return f([t,u])}}function f(t){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,t[0]&&(n=0)),n;)try{if(a=1,r&&(e=t[0]&2?r.return:t[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;switch(r=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,r=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=c.call(o,n)}catch(u){t=[6,u],r=0}finally{a=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(m,"__esModule",{value:!0});m.base64ToBlob=z;function z(o){return P(this,void 0,void 0,function(){var c,n,a;return A(this,function(r){switch(r.label){case 0:return[4,fetch(o)];case 1:return c=r.sent(),[4,c.blob()];case 2:return n=r.sent(),a=N(o),a&&(n=n.slice(0,n.size,a)),[2,n]}})})}var G=/^data:(.+);base64,/;function N(o){var c;return(c=o.match(G))===null||c===void 0?void 0:c.slice(1,2).pop()}var w={},U=s&&s.__awaiter||function(o,c,n,a){function r(e){return e instanceof n?e:new n(function(i){i(e)})}return new(n||(n=Promise))(function(e,i){function l(u){try{t(a.next(u))}catch(d){i(d)}}function f(u){try{t(a.throw(u))}catch(d){i(d)}}function t(u){u.done?e(u.value):r(u.value).then(l,f)}t((a=a.apply(o,c||[])).next())})},D=s&&s.__generator||function(o,c){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a,r,e,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(u){return f([t,u])}}function f(t){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,t[0]&&(n=0)),n;)try{if(a=1,r&&(e=t[0]&2?r.return:t[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;switch(r=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,r=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=c.call(o,n)}catch(u){t=[6,u],r=0}finally{a=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0});w.base64ToFile=W;function W(o,c,n){return U(this,void 0,void 0,function(){var a,r;return D(this,function(e){switch(e.label){case 0:return[4,fetch(o)];case 1:return a=e.sent(),[4,a.blob()];case 2:return r=e.sent(),[2,new File([r],c,n)]}})})}var y={},_=s&&s.__awaiter||function(o,c,n,a){function r(e){return e instanceof n?e:new n(function(i){i(e)})}return new(n||(n=Promise))(function(e,i){function l(u){try{t(a.next(u))}catch(d){i(d)}}function f(u){try{t(a.throw(u))}catch(d){i(d)}}function t(u){u.done?e(u.value):r(u.value).then(l,f)}t((a=a.apply(o,c||[])).next())})},g=s&&s.__generator||function(o,c){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a,r,e,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(t){return function(u){return f([t,u])}}function f(t){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,t[0]&&(n=0)),n;)try{if(a=1,r&&(e=t[0]&2?r.return:t[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;switch(r=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,r=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=c.call(o,n)}catch(u){t=[6,u],r=0}finally{a=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(y,"__esModule",{value:!0});y.blobToBase64=J;function J(o){return _(this,void 0,void 0,function(){return g(this,function(c){return[2,typeof FileReader=="function"?K(o):H(o)]})})}var h;(function(o){o.error="error",o.loadend="loadend"})(h||(h={}));function K(o){return _(this,void 0,void 0,function(){return g(this,function(c){return[2,new Promise(function(n,a){try{var r=new FileReader,e=function(){n(r.result),r.removeEventListener(h.loadend,e)};r.addEventListener(h.loadend,e);var i=function(){a(r.error),r.removeEventListener(h.error,i)};r.addEventListener(h.error,i),r.readAsDataURL(o)}catch(l){a(l)}})]})})}var q="application/octet-stream";function H(o){return _(this,void 0,void 0,function(){var c,n,a,r;return g(this,function(e){switch(e.label){case 0:return a=(n=Buffer).from,[4,o.text()];case 1:return c=a.apply(n,[e.sent()]),r=o.type||q,[2,"data:".concat(r,";base64,").concat(c.toString("base64"))]}})})}var S={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.fileToBase64=void 0;var c=y;Object.defineProperty(o,"fileToBase64",{enumerable:!0,get:function(){return c.blobToBase64}})})(S);(function(o){var c=s&&s.__createBinding||(Object.create?function(a,r,e,i){i===void 0&&(i=e);var l=Object.getOwnPropertyDescriptor(r,e);(!l||("get"in l?!r.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(a,i,l)}:function(a,r,e,i){i===void 0&&(i=e),a[i]=r[e]}),n=s&&s.__exportStar||function(a,r){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(r,e)&&c(r,a,e)};Object.defineProperty(o,"__esModule",{value:!0}),n(m,o),n(w,o),n(y,o),n(S,o)})(C);var Q=function(o){I(c,o);function c(){return o!==null&&o.apply(this,arguments)||this}return c.prototype.uploadFile=function(n,a){return T(this,void 0,void 0,function(){var r,e,i;return j(this,function(l){switch(l.label){case 0:return r=k(a,"post"),r.data?[3,2]:(e=new FormData,[4,C.base64ToBlob(n)]);case 1:i=l.sent(),e.append("file",i,"signature.png"),r.data=e,l.label=2;case 2:return[2,this.props.env.fetcher(r,E(this.props.data,{file:n}))]}})})},c.prototype.handleChange=function(n){var a,r;return T(this,void 0,void 0,function(){var e,i,l,f,t,u,d,B;return j(this,function(v){switch(v.label){case 0:if(e=this.props,i=e.translate,l=e.uploadApi,f=e.embed,t=e.onChange,!f||!l||n===void 0)return t==null||t(n),[2];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.uploadFile(n,l)];case 2:if(u=v.sent(),!u.ok||u.status&&u.status!=="0"||!u.data)throw new Error(u.msg||i("File.errorRetry"));return d=u.data.value||u.data.url||u.data,t==null||t(d),[3,4];case 3:return B=v.sent(),t==null||t(""),(r=(a=this.props.env)===null||a===void 0?void 0:a.alert)===null||r===void 0||r.call(a,B.message||i("File.errorRetry")),[3,4];case 4:return[2]}})})},c.prototype.render=function(){var n=this.props,a=n.classnames,r=n.className,e=F(this.props,["value","width","height","mobileUI","embed","color","bgColor","clearBtnLabel","clearBtnIcon","undoBtnLabel","undoBtnIcon","confirmBtnLabel","confirmBtnIcon","embedConfirmLabel","embedConfirmIcon","ebmedCancelLabel","ebmedCancelIcon","embedBtnIcon","embedBtnLabel","uploadApi"]);return O.createElement(R,L({classnames:a,className:r,onChange:this.handleChange},e))},p([x,b("design:type",Function),b("design:paramtypes",[String,String]),b("design:returntype",Promise)],c.prototype,"uploadFile",null),p([x,b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",Promise)],c.prototype,"handleChange",null),c}(O.Component),X=function(o){I(c,o);function c(n,a){var r=o.call(this,n)||this,e=a;return e.registerComponent(r),r}return c.prototype.componentWillUnmount=function(){var n;(n=o.prototype.componentWillUnmount)===null||n===void 0||n.call(this);var a=this.context;a.unRegisterComponent(this)},c.contextType=$,c=p([M({type:"input-signature",sizeMutable:!1}),b("design:paramtypes",[Object,Object])],c),c}(Q);export{X as InputSignatureRenderer,Q as default};
